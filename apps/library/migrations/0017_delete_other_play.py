# Generated by Django 3.2.12 on 2022-03-21 18:05

from django.db import migrations, models
import django.db.models.deletion


def add_program_type(apps, schema_editor):
    ProgramType = apps.get_model("library", "ProgramType")
    ProgramType.objects.get_or_create(
        name="Другие пьесы",
        slug="other_plays"
    )

def delete_other_play_perms(apps, schema_editor):
    Permission = apps.get_model("auth", "Permission")
    other_play_permission = Permission.objects.filter(codename__endswith="_otherplay")
    other_play_permission.delete()


class Migration(migrations.Migration):

    dependencies = [
        ('library', '0016_participationapplicationfestival_festival_year'),
    ]

    operations = [
        migrations.RunPython(
            add_program_type
        ),
        migrations.AlterField(
            model_name='play',
            name='name',
            field=models.CharField(max_length=70, verbose_name='Название пьесы'),
        ),
        migrations.AlterField(
            model_name='play',
            name='festival',
            field=models.ForeignKey(blank=True, help_text='Для пьес Любимовки должен быть выбран Фестиваль', null=True, on_delete=django.db.models.deletion.PROTECT, related_name='plays', to='info.festival', verbose_name='Фестиваль'),
        ),
        migrations.DeleteModel(
            name='OtherPlay',
        ),
        migrations.RunPython(
            delete_other_play_perms
        ),
    ]

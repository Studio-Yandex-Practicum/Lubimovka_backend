# Generated by Django 3.2.13 on 2022-08-17 15:36

from django.db import migrations, models

def set_order(apps, schema_editor):
    Performance = apps.get_model("afisha", "Performance")
    for performance in Performance.objects.all():
        for order, team_member in enumerate(performance.team_members.all().order_by("role"), 1):
            team_member.order = order
            team_member.save(update_fields=("order",))


def reverse(apps, schema_editor):
    pass


class Migration(migrations.Migration):

    dependencies = [
        ('library', '0037_alter_authorplay_author'),
    ]

    operations = [
        migrations.AlterModelOptions(
            name='teammember',
            options={'ordering': ('order',), 'verbose_name': 'Член команды', 'verbose_name_plural': 'Члены команды'},
        ),
        migrations.AddField(
            model_name='teammember',
            name='order',
            field=models.PositiveSmallIntegerField(db_index=True, default=0, verbose_name='Порядок'),
        ),
        migrations.RunPython(set_order, reverse),
    ]
